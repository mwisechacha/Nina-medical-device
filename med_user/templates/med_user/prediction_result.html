<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Model Screening Results</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/results.css' %}">
</head>
<body>
    <div class="results-container">
        <div class="logo-container">
            <img src="{% static 'images/nina-logo.png' %}" alt="Nina Logo">
        </div>
        
        <div class="content-wrapper">
            <div class="heatmap-section">
                <h2>Original Sensor Data</h2>
                <div class="heatmap-wrapper">
                    <table class="heatmap">
                        {% for row in sensor_data %}
                        <tr>
                            {% for value in row %}
                            <td style="background: {% if value <= 30 %}#6fcf97{% elif value <= 60 %}#f2c94c{% else %}#f2994a{% endif %};">
                                {{ value }}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </table>
                </div>
                
                <div class="upsampled-visualization">
                    <h3>How the AI Sees Your Data</h3>
                    {% if visualization_url %}
                    <div class="visualization-comparison">
                        <div class="upsampled-image">
                            <h4>Model Input (224x224)</h4>
                            <img src="{{ visualization_url }}" alt="Upsampled data visualization">
                        </div>
                    </div>
                    <p class="visualization-note">
                        The AI model analyzes an upsampled version of your sensor data to detect complex patterns.
                        Green areas represent normal tissue, yellow shows potential benign findings, 
                        and orange/red indicates areas of concern.
                    </p>
                    {% else %}
                    <p>Visualization not available</p>
                    {% endif %}
                </div>
            </div>
            
            <div class="diagnosis-section">
                <h2>AI Model Analysis</h2>
                
                <div class="diagnosis-card diagnosis-{% if diagnosis == 'Malignant' %}high{% else %}low{% endif %}">
                    <h3>{% if diagnosis == 'Malignant' %}Malignant - Possible Tumor{% else %}Benign - Likely Normal{% endif %}</h3>
                    
                    <div class="model-details">
                        <h4>Model Confidence: <span class="confidence-value">85%</span></h4>
                        <div class="confidence-bar">
                            <div class="confidence-fill" style="width: 85%;"></div>
                        </div>
                    </div>
                    
                    <div class="recommendation">
                        <h4>Recommendation:</h4>
                        {% if diagnosis == 'Malignant' %}
                        <p>Our AI model has detected patterns consistent with malignant tissue. Please consult with a healthcare professional immediately for further evaluation.</p>
                        {% else %}
                        <p>The AI analysis suggests benign characteristics. However, if you have any concerns, we recommend consulting with your healthcare provider.</p>
                        {% endif %}
                    </div>
                </div>
                
                <div class="comparison-note">
                    <h4>About This Analysis:</h4>
                    <p>This result is generated by our deep learning model trained on thousands of breast ultrasound images. It looks for complex patterns that may not be evident in simple threshold rules.</p>
                </div>
                
                <div class="action-buttons">
                    <a href="{% url 'rule_based_result' screening_id %}" class="btn btn-rules">
                        View Rule-Based Analysis
                    </a>
                    <a href="{% url 'home' %}" class="btn btn-home">
                        Return to Home
                    </a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>